CAPI=2:
name : ::azadi:1.0

filesets:
  risc:
    depend:
      - azadi_pkg
      - lowrisc:ibex:ibex_core
      #- lowrisc:tool:check_tool_requirements
    files:
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/defs_div_sqrt_mvp.sv
      #- verif/verilator/debug/prog_image_loader_pkg.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_tracer_pkg.sv
      #- src/vendor/pulp_fpnew/src/fpnew_pkg.sv
      #- src/vendor/pulp_fpnew/src/common_cells/src/cf_math_pkg.sv
      #- src/vendor/pulp_fpnew/src/common_cells/src/ecc_pkg.sv
      #- src/vendor/pulp_fpnew/src/common_cells/src/cb_filter_pkg.sv
      #- src/vendor/pulp_riscv_dbg/src/dm_pkg.sv
      #- src/vendor/pulp_riscv_dbg/tb/dm_tb_pkg.sv
      #- src/periph/rv_plic/rtl/rv_plic_reg_pkg.sv
      #- src/periph/rv_timer/rtl/rv_timer_reg_pkg.sv
      #- src/periph/gpio/rtl/gpio_reg_pkg.sv
      #- src/periph/rv_dm/rtl/jtag_pkg.sv
      #- src/ip/xbar/rtl/tl_main_pkg.sv
      #- src/common/rtl/tlul_pkg.sv
      #- src/common/rtl/prim_pkg.sv
      #- src/common/rtl/prim_util_pkg.sv
      - src/periph/spi_host/rtl/spi_defines.v
      #- src/vendor/lowrisc_ibex/rtl/ibex_if_stage.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_csr.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_register_file_ff.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_controller.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_branch_predict.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_fp_register_file_ff.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_pmp.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_id_stage.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_ex_block.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_decoder.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_load_store_unit.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_multdiv_slow.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_wb_stage.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_fetch_fifo.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_icache.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_compressed_decoder.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_register_file_latch.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_alu.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_multdiv_fast.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_core_tracing.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_core.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_prefetch_buffer.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_counter.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_cs_registers.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_tracer.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_register_file_fpga.sv
      #- src/vendor/lowrisc_ibex/rtl/ibex_dummy_instr.sv
      #- src/vendor/pulp_fpnew/src/fpnew_opgroup_block.sv
      #- src/vendor/pulp_fpnew/src/fpnew_opgroup_multifmt_slice.sv
      #- src/vendor/pulp_fpnew/src/fpnew_top.sv
      #- src/vendor/pulp_fpnew/src/fpnew_fma.sv
      #- src/vendor/pulp_fpnew/src/fpnew_noncomp.sv
      #- src/vendor/pulp_fpnew/src/fpnew_opgroup_fmt_slice.sv
      #- src/vendor/pulp_fpnew/src/fpnew_divsqrt_multi.sv
      #- src/vendor/pulp_fpnew/src/fpnew_classifier.sv
      #- src/vendor/pulp_fpnew/src/fpnew_rounding.sv
      #- src/vendor/pulp_fpnew/src/fpnew_fma_multi.sv
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/div_sqrt_top_mvp.sv
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/norm_div_sqrt_mvp.sv
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/control_mvp.sv
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/preprocess_mvp.sv
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/nrbd_nrsc_mvp.sv
      #- src/vendor/pulp_fpnew/src/fpu_div_sqrt_mvp/hdl/iteration_div_sqrt_mvp.sv
      #- src/vendor/pulp_fpnew/src/fpnew_cast_multi.sv
      #- src/vendor/pulp_fpnew/src/common_cells/src/rr_arb_tree.sv
      #- src/vendor/pulp_fpnew/src/common_cells/src/lzc.sv
      - src/ip/sram_interfaces/rtl/instr_mem_top.sv
      - src/ip/sram_interfaces/rtl/data_mem_top.sv
      - src/ip/sram_interfaces/rtl/sram_32x1024.sv
      - src/ip/program_loader/rtl/uart_rx_prog.v
      - src/ip/program_loader/rtl/programmer.sv
      - src/ip/program_loader/rtl/iccm_controller.v
      - src/ip/xbar/rtl/tl_xbar_main.sv
      - src/top/azadi_top_verilator.sv
      - src/top/azadi_soc_top.sv
      - src/top/ibex_core_top.sv
      - src/periph/gpio/rtl/gpio.sv
      - src/periph/gpio/rtl/gpio_reg_top.sv
      - src/vendor/openram/rtl/sky130_sram_1kbyte_1rw1r_32x256_8.v
      - src/periph/uart/rtl/generic_fifo.sv
      - src/periph/uart/rtl/rx_timer.sv
      - src/periph/uart/rtl/uart_tx.v
      - src/periph/uart/rtl/uart_core.v
      - src/periph/uart/rtl/uart_rx.v
      - src/periph/uart/rtl/uart_top.sv
      - src/periph/rstmgr/rtl/rstmgr.sv
      - src/periph/spi_host/rtl/spi_core.sv
      - src/periph/spi_host/rtl/spi_top.sv
      - src/periph/spi_host/rtl/spi_clgen.v
      - src/periph/spi_host/rtl/spi_shift.v
      - src/periph/rv_timer/rtl/rv_timer.sv
      - src/periph/rv_timer/rtl/rv_timer_reg_top.sv
      - src/periph/rv_timer/rtl/timer_core.sv
      - src/periph/pwm/rtl/pwm_top.sv
      - src/periph/pwm/rtl/pwm_core.v
      - src/periph/pwm/rtl/pwm_channel.v
      - src/periph/pwm/rtl/pwm_clock.v
      - src/periph/rv_plic/rtl/rv_plic.sv
      - src/periph/rv_plic/rtl/rv_plic_target.sv
      - src/periph/rv_plic/rtl/rv_plic_reg_top.sv
      - src/periph/rv_plic/rtl/rv_plic_gateway.sv
      - src/common/rtl/fifo_async.sv
      - src/common/rtl/fifo_sync.sv
      #- src/common/rtl/prim_arbiter_ppc.sv
      - src/common/rtl/prim_clock_gating.sv
      - src/common/rtl/prim_filter_ctr.sv
      #- src/common/rtl/prim_generic_clock_inv.sv
      #- src/common/rtl/prim_generic_clock_mux2.sv
      #- src/common/rtl/prim_generic_flop_2sync.sv
      #- src/common/rtl/prim_generic_flop.sv
      - src/common/rtl/prim_intr_hw.sv
      - src/common/rtl/prim_subreg_arb.sv
      - src/common/rtl/prim_subreg_ext.sv
      - src/common/rtl/prim_subreg.sv
      - src/common/rtl/tlul_adapter_reg.sv
      - src/common/rtl/tlul_err_resp.sv
      - src/common/rtl/tlul_err.sv
      - src/common/rtl/tlul_fifo_sync.sv
      - src/common/rtl/tlul_host_adapter.sv
      - src/common/rtl/tlul_socket_1n.sv
      - src/common/rtl/tlul_sram_adapter.sv
    file_type : systemVerilogSource, VerilogSource
  tb: 
    files:
      - verif/verilator/sim.cpp
    file_type: cppSource
    
targets:
  default: &default
    filesets: [risc , tb]
  sim:
    default_tool: verilator
    filesets: [risc, tb]
    parameters:
        - HEX
        - timeout
        - cycles
        - main_time
        - done
    tools:
      verilator:
        verilator_options: [--trace, --trace-structs, --trace-params, --threads 4, -Wno-IMPLICIT, -Wno-LITENDIAN, -Wno-UNSIGNED, -Wno-LATCH, -Wno-PINMISSING, -Wno-WIDTH, -Wno-MODDUP, -Wno-UNOPTFLAT, -Wno-BLKANDNBLK, -Wno-UNOPTTHREADS, -Wno-ALWCOMBORDER, --debug]
    toplevel: azadi_top_verilator
parameters:
  HEX:
    datatype: str
    paramtype: plusarg
  timeout:
    datatype: int
    paramtype: plusarg
  cycles:
    datatype: int
    paramtype: plusarg
  main_time:
    datatype: int
    paramtype: plusarg
  done:
    datatype: bool
    paramtype: plusarg