`begin_keywords "1800-2017"
`line 1 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 1
 
 
 

`line 5 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
module data_mem_top (
  input logic clk_i,
  input logic rst_ni,

`line 9 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
   
  input tlul_pkg::tlul_h2d_t tl_d_i,
  output tlul_pkg::tlul_d2h_t tl_d_o,

`line 13 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
   
  output  logic        csb,
  output  logic [12:0] addr_o,
  output  logic [31:0] wdata_o,
  output  logic [3:0]  wmask_o,
  output  logic        we_o,
  input   logic [31:0] rdata_i,

`line 21 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
   
  input   logic [31:0] boot_reg_i
);

`line 25 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  logic        tl_req;
  logic [31:0] tl_wmask;
  logic        we_i;
  logic        rvalid_o;

`line 30 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
   
  logic [31:0] boot_reg;
  logic [31:0] rdata;
  logic        read_boot_reg;

`line 35 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  always_ff @(posedge clk_i or negedge rst_ni) begin
    if (!rst_ni) begin
      boot_reg      <= '0;
      read_boot_reg <= '0;
    end else begin
      if (tl_d_i.a_address == 32'h20002000) begin
        read_boot_reg <= 1'b1;
      end else begin
        boot_reg      <= boot_reg_i;
        read_boot_reg <= 1'b0;
      end
    end
  end

`line 49 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  assign rdata = read_boot_reg ? boot_reg : rdata_i;
   

`line 52 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  assign wmask_o[0] = (tl_wmask[7:0]   != 8'b0) ? 1'b1: 1'b0;
  assign wmask_o[1] = (tl_wmask[15:8]  != 8'b0) ? 1'b1: 1'b0;
  assign wmask_o[2] = (tl_wmask[23:16] != 8'b0) ? 1'b1: 1'b0;
  assign wmask_o[3] = (tl_wmask[31:24] != 8'b0) ? 1'b1: 1'b0;

`line 57 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  assign we_o    = ~we_i;
  assign csb     = ~tl_req;

`line 60 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  tlul_sram_adapter #(
    .SramAw       (13),
    .SramDw       (32),
    .Outstanding  (2),
    .ByteAccess   (1),
    .ErrOnWrite   (0),   
    .ErrOnRead    (0)
  ) data_mem (
    .clk_i    (clk_i),
    .rst_ni   (rst_ni),
    .tl_i     (tl_d_i),
    .tl_o     (tl_d_o),
    .req_o    (tl_req),
    .gnt_i    (1'b1),
    .we_o     (we_i),
    .addr_o   (addr_o),
    .wdata_o  (wdata_o),
    .wmask_o  (tl_wmask),
    .rdata_i  (rdata),
    .rvalid_i (rvalid_o),
    .rerror_i (2'b0)
  );

`line 83 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
  always_ff @(posedge clk_i or negedge rst_ni) begin
    if (!rst_ni) begin
      rvalid_o <= 1'b0;
    end else if (we_i) begin
      rvalid_o <= 1'b0;
    end else begin
      rvalid_o <= tl_req;
    end
  end

`line 93 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 0
endmodule

`line 95 "../src/merl_azadi-II_azadi_sram_interfaces_1.0/rtl/data_mem_top.sv" 2
